select ot.rider_id,sec_to_time(sum(ot.time_diff)) from (select rider_id,convert_tz(in_time,"UTC","Asia/Kolkata") as intime,convert_tz(out_time,"UTC","Asia/Kolkata") as ontime,time_to_sec(convert_tz(now(),"UTC","Asia/Kolkata")) as timenow,time_to_sec(convert_tz(in_time,"UTC","Asia/Kolkata")) as intt,time_to_sec(convert_tz(out_time,"UTC","Asia/Kolkata")) as outt,case when out_time is null then time_to_sec(convert_tz(now(),"UTC","Asia/Kolkata"))-time_to_sec(convert_tz(in_time,"UTC","Asia/Kolkata")) else time_to_sec(convert_tz(out_time,"UTC","Asia/Kolkata"))-time_to_sec(convert_tz(in_time,"UTC","Asia/Kolkata")) end as time_diff  from coreengine_ridersession where date(convert_tz(in_time,"UTC","Asia/Kolkata")) = curdate()) as ot group by ot.rider_id